---
plan: 09-04
phase: 09-client-portal-campaign-approval
title: "Portal Campaign Detail Page — Lead Preview + Content Preview + Approval UX"
wave: 2
depends_on:
  - 09-01
  - 09-02
requirements:
  - PORTAL-01
  - PORTAL-02
  - PORTAL-03
  - PORTAL-04
  - PORTAL-05
  - PORTAL-06
  - PORTAL-07
files_modified:
  - src/app/(portal)/portal/campaigns/[id]/page.tsx
  - src/components/portal/campaign-approval-leads.tsx
  - src/components/portal/campaign-approval-content.tsx
autonomous: true
---

# Plan 09-04: Portal Campaign Detail Page

## Goal

Build the campaign detail page at `/portal/campaigns/[id]` with two independent sections: Lead Preview (top 50 by ICP score with approve/reject) and Content Preview (email accordion + LinkedIn messages with approve/reject). Each section has independent approval state. The page is a server component that passes data to client components for the interactive approval UI.

## Context

- CONTEXT.md locked decisions:
  - Lead preview: top 50 by ICP score descending, fixed sort. Fields: name, title, company, location, LinkedIn link. "Approve Leads" and "Request Changes" side by side. Feedback text area on request changes.
  - Content preview: Email steps in vertical accordion (first step expanded). Merge tokens replaced with example data, subtle highlight. Spintax resolved to first variant. LinkedIn messages in separate section below. "Approve Content" and "Request Changes" same pattern.
- API routes from 09-02 exist at `/api/portal/campaigns/[id]` (GET returns campaign + leadSample), and action routes for approve/reject.
- Content preview utilities (`resolveSpintax`, `substituteTokens`, `renderContentPreview`) from 09-01 exist in `src/lib/content-preview.ts`.
- Server/client component split: page.tsx is server component (calls `getPortalSession()` + fetches data). Passes data as props to client components for approve/reject buttons.
- Email sequence JSON format: `{ position, subjectLine, subjectVariantB?, body, delayDays, notes? }`
- LinkedIn sequence JSON format: `{ position, type, body, delayDays, notes? }`

## must_haves

- [ ] `/portal/campaigns/[id]` page exists as a server component with `getPortalSession()` guard
- [ ] Page returns 404 (redirect or not-found) if campaign doesn't exist or belongs to different workspace
- [ ] Leads section shows "Showing top 50 of N leads, ordered by ICP score" header with lead table
- [ ] Lead table shows: name (first + last), title, company, location, LinkedIn (link to profile)
- [ ] "Approve Leads" and "Request Changes" buttons present in lead section
- [ ] "Request Changes" for leads shows feedback textarea, requires text before submission
- [ ] Content section shows email steps as vertical accordion, first step expanded by default
- [ ] Email step preview resolves spintax (first variant) and substitutes merge tokens with example data
- [ ] Personalized parts (substituted tokens) are visually highlighted in the preview
- [ ] LinkedIn messages section shows below email content when campaign has LinkedIn channel
- [ ] "Approve Content" and "Request Changes" buttons present in content section
- [ ] Lead and content approval are fully independent in the UI (PORTAL-06)
- [ ] After approval/rejection, page refreshes to show updated state

## Tasks

<task id="09-04-T1">
<title>Create campaign detail server component page</title>
<details>

**File:** `src/app/(portal)/portal/campaigns/[id]/page.tsx` (NEW)

Server component pattern: `getPortalSession()` -> fetch campaign + leads -> render with client children.

```typescript
import { notFound } from "next/navigation";
import { getPortalSession } from "@/lib/portal-session";
import { getCampaign, getCampaignLeadSample } from "@/lib/campaigns/operations";
import { CampaignApprovalLeads } from "@/components/portal/campaign-approval-leads";
import { CampaignApprovalContent } from "@/components/portal/campaign-approval-content";
import { Badge } from "@/components/ui/badge";
import { ArrowLeft, Mail, Linkedin } from "lucide-react";
import Link from "next/link";
import { cn } from "@/lib/utils";

export default async function PortalCampaignDetailPage({
  params,
}: {
  params: Promise<{ id: string }>;
}) {
  const { id } = await params;
  const { workspaceSlug } = await getPortalSession();

  const campaign = await getCampaign(id);
  if (!campaign || campaign.workspaceSlug !== workspaceSlug) {
    notFound();
  }

  // Fetch lead sample if campaign has a target list
  let leadSample: Awaited<ReturnType<typeof getCampaignLeadSample>> | null = null;
  if (campaign.targetListId) {
    leadSample = await getCampaignLeadSample(
      campaign.targetListId,
      workspaceSlug,
    );
  }

  // Status badge config
  const statusConfig: Record<string, { label: string; className: string }> = {
    draft: { label: "Draft", className: "bg-gray-100 text-gray-800" },
    internal_review: { label: "In Review", className: "bg-blue-100 text-blue-800" },
    pending_approval: { label: "Needs Approval", className: "bg-amber-100 text-amber-800" },
    approved: { label: "Approved", className: "bg-emerald-100 text-emerald-800" },
    deployed: { label: "Deployed", className: "bg-purple-100 text-purple-800" },
    active: { label: "Active", className: "bg-emerald-100 text-emerald-800" },
    paused: { label: "Paused", className: "bg-yellow-100 text-yellow-800" },
    completed: { label: "Completed", className: "bg-blue-100 text-blue-800" },
  };
  const config = statusConfig[campaign.status] ?? {
    label: campaign.status,
    className: "bg-gray-100 text-gray-800",
  };

  return (
    <div className="space-y-6">
      {/* Back link + header */}
      <div>
        <Link
          href="/portal/campaigns"
          className="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-3"
        >
          <ArrowLeft className="h-3.5 w-3.5" />
          Back to Campaigns
        </Link>
        <div className="flex items-center gap-3">
          <h1 className="text-2xl font-heading font-bold">{campaign.name}</h1>
          <Badge className={cn("text-xs", config.className)}>{config.label}</Badge>
        </div>
        {campaign.description && (
          <p className="text-sm text-muted-foreground mt-1">{campaign.description}</p>
        )}
        <div className="flex items-center gap-3 mt-2 text-sm text-muted-foreground">
          {campaign.channels.includes("email") && (
            <span className="inline-flex items-center gap-1">
              <Mail className="h-3.5 w-3.5" /> Email
            </span>
          )}
          {campaign.channels.includes("linkedin") && (
            <span className="inline-flex items-center gap-1">
              <Linkedin className="h-3.5 w-3.5" /> LinkedIn
            </span>
          )}
        </div>
      </div>

      {/* Leads Section */}
      <CampaignApprovalLeads
        campaignId={campaign.id}
        leads={leadSample?.leads ?? []}
        totalCount={leadSample?.totalCount ?? 0}
        leadsApproved={campaign.leadsApproved}
        leadsFeedback={campaign.leadsFeedback}
        isPending={campaign.status === "pending_approval"}
      />

      {/* Content Section */}
      <CampaignApprovalContent
        campaignId={campaign.id}
        emailSequence={campaign.emailSequence as unknown[] | null}
        linkedinSequence={campaign.linkedinSequence as unknown[] | null}
        channels={campaign.channels}
        contentApproved={campaign.contentApproved}
        contentFeedback={campaign.contentFeedback}
        isPending={campaign.status === "pending_approval"}
      />
    </div>
  );
}
```

**Key details:**
- Uses `notFound()` from `next/navigation` if campaign doesn't exist or workspace doesn't match — Next.js renders the nearest `not-found.tsx` (which already exists at portal level).
- Passes serializable data to client components as props. No functions or Prisma objects.
- `campaign.emailSequence` and `campaign.linkedinSequence` are already parsed by `formatCampaignDetail()` in operations.ts — they come back as `unknown[]` arrays.

</details>
</task>

<task id="09-04-T2">
<title>Create CampaignApprovalLeads client component</title>
<details>

**File:** `src/components/portal/campaign-approval-leads.tsx` (NEW)

Client component that shows the lead table and approve/reject buttons.

```tsx
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { CheckCircle2, MessageSquare, ExternalLink } from "lucide-react";
import { cn } from "@/lib/utils";

interface LeadSample {
  personId: string;
  firstName: string | null;
  lastName: string | null;
  jobTitle: string | null;
  company: string | null;
  location: string | null;
  linkedinUrl: string | null;
  icpScore: number | null;
}

interface Props {
  campaignId: string;
  leads: LeadSample[];
  totalCount: number;
  leadsApproved: boolean;
  leadsFeedback: string | null;
  isPending: boolean;
}

export function CampaignApprovalLeads({
  campaignId,
  leads,
  totalCount,
  leadsApproved,
  leadsFeedback,
  isPending,
}: Props) {
  const router = useRouter();
  const [showFeedback, setShowFeedback] = useState(false);
  const [feedback, setFeedback] = useState("");
  const [loading, setLoading] = useState(false);

  const canAct = isPending && !leadsApproved;

  async function handleApprove() {
    setLoading(true);
    await fetch(`/api/portal/campaigns/${campaignId}/approve-leads`, {
      method: "POST",
    });
    setLoading(false);
    router.refresh();
  }

  async function handleRequestChanges() {
    if (!feedback.trim()) return;
    setLoading(true);
    await fetch(`/api/portal/campaigns/${campaignId}/request-changes-leads`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ feedback: feedback.trim() }),
    });
    setLoading(false);
    setShowFeedback(false);
    setFeedback("");
    router.refresh();
  }

  return (
    <Card>
      <CardHeader>
        <div className="flex items-center justify-between">
          <CardTitle className="font-heading text-lg">Leads</CardTitle>
          {leadsApproved && (
            <span className="inline-flex items-center gap-1 text-sm text-emerald-700 font-medium">
              <CheckCircle2 className="h-4 w-4" /> Approved
            </span>
          )}
        </div>
        {totalCount > 0 && (
          <p className="text-sm text-muted-foreground">
            Showing top {Math.min(leads.length, 50)} of {totalCount.toLocaleString()} leads, ordered by ICP score
          </p>
        )}
      </CardHeader>
      <CardContent>
        {/* Previous feedback banner */}
        {leadsFeedback && !leadsApproved && (
          <div className="rounded-lg border border-amber-200 bg-amber-50 p-3 mb-4 text-sm">
            <p className="font-medium text-amber-800 mb-1">Changes Requested</p>
            <p className="text-amber-700">{leadsFeedback}</p>
          </div>
        )}

        {leads.length === 0 ? (
          <p className="text-center py-8 text-muted-foreground">
            No leads linked to this campaign yet.
          </p>
        ) : (
          <div className="overflow-x-auto">
            <Table>
              <TableHeader>
                <TableRow>
                  <TableHead>Name</TableHead>
                  <TableHead>Title</TableHead>
                  <TableHead>Company</TableHead>
                  <TableHead>Location</TableHead>
                  <TableHead>LinkedIn</TableHead>
                  <TableHead className="text-right">ICP Score</TableHead>
                </TableRow>
              </TableHeader>
              <TableBody>
                {leads.map((lead) => (
                  <TableRow key={lead.personId}>
                    <TableCell className="font-medium whitespace-nowrap">
                      {[lead.firstName, lead.lastName].filter(Boolean).join(" ") || "—"}
                    </TableCell>
                    <TableCell>{lead.jobTitle ?? "—"}</TableCell>
                    <TableCell>{lead.company ?? "—"}</TableCell>
                    <TableCell>{lead.location ?? "—"}</TableCell>
                    <TableCell>
                      {lead.linkedinUrl ? (
                        <a
                          href={lead.linkedinUrl}
                          target="_blank"
                          rel="noopener noreferrer"
                          className="inline-flex items-center gap-1 text-blue-600 hover:underline text-sm"
                        >
                          Profile <ExternalLink className="h-3 w-3" />
                        </a>
                      ) : (
                        "—"
                      )}
                    </TableCell>
                    <TableCell className="text-right">
                      {lead.icpScore !== null ? (
                        <span
                          className={cn(
                            "font-medium",
                            lead.icpScore >= 70
                              ? "text-emerald-700"
                              : lead.icpScore >= 40
                                ? "text-amber-700"
                                : "text-gray-500",
                          )}
                        >
                          {lead.icpScore}
                        </span>
                      ) : (
                        "—"
                      )}
                    </TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          </div>
        )}

        {/* Approval buttons — only show when campaign is pending and leads not yet approved */}
        {canAct && leads.length > 0 && (
          <div className="mt-6 space-y-3">
            <div className="flex items-center gap-3">
              <Button
                onClick={handleApprove}
                disabled={loading}
                className="bg-emerald-600 hover:bg-emerald-700 text-white"
              >
                Approve Leads
              </Button>
              <Button
                variant="outline"
                onClick={() => setShowFeedback(!showFeedback)}
                disabled={loading}
              >
                <MessageSquare className="h-4 w-4 mr-1" />
                Request Changes
              </Button>
            </div>

            {showFeedback && (
              <div className="space-y-2">
                <Textarea
                  placeholder="Describe what changes you'd like (e.g., 'too many US-based leads, need more UK')..."
                  value={feedback}
                  onChange={(e) => setFeedback(e.target.value)}
                  rows={3}
                />
                <Button
                  onClick={handleRequestChanges}
                  disabled={loading || !feedback.trim()}
                  variant="destructive"
                  size="sm"
                >
                  Submit Feedback
                </Button>
              </div>
            )}
          </div>
        )}
      </CardContent>
    </Card>
  );
}
```

**Key details:**
- `canAct` = `isPending && !leadsApproved` — buttons only show when the campaign is pending and this section hasn't been approved yet.
- After approval or rejection, `router.refresh()` triggers a server component re-render to show updated state.
- Previous feedback is displayed as an amber banner if there was a rejection.
- ICP scores get color coding: green (70+), amber (40-69), gray (<40).
- LinkedIn links open in new tab with `rel="noopener noreferrer"`.

</details>
</task>

<task id="09-04-T3">
<title>Create CampaignApprovalContent client component</title>
<details>

**File:** `src/components/portal/campaign-approval-content.tsx` (NEW)

Client component with email step accordion and LinkedIn message display, plus approve/reject buttons.

This component needs to import and use the content preview utilities from `src/lib/content-preview.ts`. Since it's a client component and the preview functions are pure (no server-only deps), they can be imported directly.

```tsx
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";
import { CheckCircle2, MessageSquare, ChevronDown, Mail, Linkedin } from "lucide-react";
import { cn } from "@/lib/utils";
import { resolveSpintax, substituteTokens } from "@/lib/content-preview";

interface EmailStep {
  position: number;
  subjectLine: string;
  subjectVariantB?: string;
  body: string;
  delayDays: number;
  notes?: string;
}

interface LinkedInStep {
  position: number;
  type: string;
  body: string;
  delayDays: number;
  notes?: string;
}

interface Props {
  campaignId: string;
  emailSequence: unknown[] | null;
  linkedinSequence: unknown[] | null;
  channels: string[];
  contentApproved: boolean;
  contentFeedback: string | null;
  isPending: boolean;
}

/**
 * Render text with spintax resolved and merge tokens highlighted.
 */
function PreviewText({ raw }: { raw: string }) {
  const afterSpintax = resolveSpintax(raw);
  const { result, tokensFound } = substituteTokens(afterSpintax);

  if (tokensFound.length === 0) {
    return <span>{result}</span>;
  }

  // Split the result to highlight token substitutions
  // We'll do a simple approach: run substituteTokens to get the final text,
  // then wrap known substitution values in a highlight span.
  // For a robust approach, we'll re-process to find positions.
  const parts: React.ReactNode[] = [];
  let remaining = afterSpintax;
  let key = 0;

  // Replace tokens one at a time, building highlighted JSX
  const tokenRegex = /\{([A-Z_]+)\}/g;
  let lastIndex = 0;
  let match;

  while ((match = tokenRegex.exec(remaining)) !== null) {
    const token = match[1];
    const EXAMPLE_DATA: Record<string, string> = {
      FIRSTNAME: "Alex",
      LASTNAME: "Smith",
      COMPANYNAME: "Acme Corp",
      COMPANY: "Acme Corp",
      JOBTITLE: "Head of Operations",
      WEBSITE: "acmecorp.com",
      TITLE: "Head of Operations",
      LOCATION: "London, UK",
    };
    const replacement = EXAMPLE_DATA[token];

    if (replacement) {
      // Add text before the token
      if (match.index > lastIndex) {
        parts.push(
          <span key={key++}>{remaining.slice(lastIndex, match.index)}</span>,
        );
      }
      // Add highlighted replacement
      parts.push(
        <mark
          key={key++}
          className="bg-[#F0FF7A]/30 text-foreground rounded px-0.5"
          title={`{${token}}`}
        >
          {replacement}
        </mark>,
      );
      lastIndex = match.index + match[0].length;
    }
  }

  // Add remaining text
  if (lastIndex < remaining.length) {
    parts.push(<span key={key++}>{remaining.slice(lastIndex)}</span>);
  }

  return <>{parts}</>;
}

export function CampaignApprovalContent({
  campaignId,
  emailSequence,
  linkedinSequence,
  channels,
  contentApproved,
  contentFeedback,
  isPending,
}: Props) {
  const router = useRouter();
  const [openStep, setOpenStep] = useState<number>(0); // First step open by default
  const [showFeedback, setShowFeedback] = useState(false);
  const [feedback, setFeedback] = useState("");
  const [loading, setLoading] = useState(false);

  const canAct = isPending && !contentApproved;

  const emailSteps = (emailSequence ?? []) as EmailStep[];
  const linkedinSteps = (linkedinSequence ?? []) as LinkedInStep[];

  const hasEmail = channels.includes("email") && emailSteps.length > 0;
  const hasLinkedIn = channels.includes("linkedin") && linkedinSteps.length > 0;

  async function handleApprove() {
    setLoading(true);
    await fetch(`/api/portal/campaigns/${campaignId}/approve-content`, {
      method: "POST",
    });
    setLoading(false);
    router.refresh();
  }

  async function handleRequestChanges() {
    if (!feedback.trim()) return;
    setLoading(true);
    await fetch(
      `/api/portal/campaigns/${campaignId}/request-changes-content`,
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ feedback: feedback.trim() }),
      },
    );
    setLoading(false);
    setShowFeedback(false);
    setFeedback("");
    router.refresh();
  }

  const typeLabels: Record<string, string> = {
    connection_request: "Connection Request",
    follow_up: "Follow-Up Message",
    message: "Message",
  };

  return (
    <Card>
      <CardHeader>
        <div className="flex items-center justify-between">
          <CardTitle className="font-heading text-lg">Content</CardTitle>
          {contentApproved && (
            <span className="inline-flex items-center gap-1 text-sm text-emerald-700 font-medium">
              <CheckCircle2 className="h-4 w-4" /> Approved
            </span>
          )}
        </div>
      </CardHeader>
      <CardContent>
        {/* Previous feedback banner */}
        {contentFeedback && !contentApproved && (
          <div className="rounded-lg border border-amber-200 bg-amber-50 p-3 mb-4 text-sm">
            <p className="font-medium text-amber-800 mb-1">Changes Requested</p>
            <p className="text-amber-700">{contentFeedback}</p>
          </div>
        )}

        {!hasEmail && !hasLinkedIn ? (
          <p className="text-center py-8 text-muted-foreground">
            No content has been added to this campaign yet.
          </p>
        ) : (
          <div className="space-y-6">
            {/* Email Sequence Accordion */}
            {hasEmail && (
              <div>
                <h3 className="flex items-center gap-2 text-sm font-medium text-muted-foreground mb-3">
                  <Mail className="h-4 w-4" /> Email Sequence
                </h3>
                <div className="space-y-2">
                  {emailSteps.map((step, idx) => (
                    <div key={idx} className="border rounded-lg">
                      <button
                        onClick={() =>
                          setOpenStep(openStep === idx ? -1 : idx)
                        }
                        className="w-full flex items-center justify-between px-4 py-3 text-left cursor-pointer hover:bg-muted/30 transition-colors"
                      >
                        <span className="font-medium text-sm">
                          Step {step.position} (Day {step.delayDays})
                        </span>
                        <ChevronDown
                          className={cn(
                            "h-4 w-4 transition-transform text-muted-foreground",
                            openStep === idx && "rotate-180",
                          )}
                        />
                      </button>
                      {openStep === idx && (
                        <div className="px-4 pb-4 space-y-3 border-t">
                          <div className="pt-3">
                            <p className="text-xs text-muted-foreground mb-1">
                              Subject
                            </p>
                            <p className="font-medium text-sm">
                              <PreviewText raw={step.subjectLine} />
                            </p>
                            {step.subjectVariantB && (
                              <p className="text-xs text-muted-foreground mt-2">
                                Variant B:{" "}
                                <span className="text-foreground">
                                  <PreviewText raw={step.subjectVariantB} />
                                </span>
                              </p>
                            )}
                          </div>
                          <div>
                            <p className="text-xs text-muted-foreground mb-1">
                              Body
                            </p>
                            <div className="whitespace-pre-wrap text-sm leading-relaxed">
                              <PreviewText raw={step.body} />
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* LinkedIn Messages */}
            {hasLinkedIn && (
              <div>
                <h3 className="flex items-center gap-2 text-sm font-medium text-muted-foreground mb-3">
                  <Linkedin className="h-4 w-4" /> LinkedIn Messages
                </h3>
                <div className="space-y-3">
                  {linkedinSteps.map((step, idx) => (
                    <div key={idx} className="border rounded-lg p-4">
                      <div className="flex items-center justify-between mb-2">
                        <span className="text-sm font-medium">
                          {typeLabels[step.type] ?? step.type} (Day{" "}
                          {step.delayDays})
                        </span>
                        <span className="text-xs text-muted-foreground">
                          Step {step.position}
                        </span>
                      </div>
                      <div className="whitespace-pre-wrap text-sm leading-relaxed">
                        <PreviewText raw={step.body} />
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        )}

        {/* Approval buttons */}
        {canAct && (hasEmail || hasLinkedIn) && (
          <div className="mt-6 space-y-3">
            <div className="flex items-center gap-3">
              <Button
                onClick={handleApprove}
                disabled={loading}
                className="bg-emerald-600 hover:bg-emerald-700 text-white"
              >
                Approve Content
              </Button>
              <Button
                variant="outline"
                onClick={() => setShowFeedback(!showFeedback)}
                disabled={loading}
              >
                <MessageSquare className="h-4 w-4 mr-1" />
                Request Changes
              </Button>
            </div>

            {showFeedback && (
              <div className="space-y-2">
                <Textarea
                  placeholder="Describe what changes you'd like (e.g., 'too formal, simplify the CTA')..."
                  value={feedback}
                  onChange={(e) => setFeedback(e.target.value)}
                  rows={3}
                />
                <Button
                  onClick={handleRequestChanges}
                  disabled={loading || !feedback.trim()}
                  variant="destructive"
                  size="sm"
                >
                  Submit Feedback
                </Button>
              </div>
            )}
          </div>
        )}
      </CardContent>
    </Card>
  );
}
```

**Key details:**
- `PreviewText` component renders text with spintax resolved and merge tokens highlighted using `<mark>` with the brand color at 30% opacity.
- The accordion uses simple `useState<number>` — first step (index 0) is open by default.
- LinkedIn messages are displayed as simple cards (not accordion) since there are typically fewer.
- Subject variant B is shown as a smaller note below the primary subject line.
- The `resolveSpintax` and `substituteTokens` imports work in client components because they're pure functions with no server-only dependencies.
- The `EXAMPLE_DATA` is duplicated in `PreviewText` for the highlighting logic. This is intentional — the utility module is for the simple `renderContentPreview()` pipeline, but for highlighting we need token-level granularity.

</details>
</task>

## Verification

```bash
# 1. Campaign detail page exists
ls -la src/app/\(portal\)/portal/campaigns/\[id\]/page.tsx

# 2. Client components exist
ls -la src/components/portal/campaign-approval-leads.tsx
ls -la src/components/portal/campaign-approval-content.tsx

# 3. Content preview imports work
grep "content-preview" src/components/portal/campaign-approval-content.tsx

# 4. Router.refresh() used for state update
grep "router.refresh" src/components/portal/campaign-approval-leads.tsx
grep "router.refresh" src/components/portal/campaign-approval-content.tsx

# 5. TypeScript compiles
npx tsc --noEmit --pretty 2>&1 | head -30
```
